# ğŸŸï¸ TicketProject â€” ê³µì—° ì˜ˆë§¤ ë° ê´€ë¦¬ ì‹œìŠ¤í…œ

## ğŸ“‘ ëª©ì°¨ (README ToC)


- [ğŸ“… í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
- [ğŸ§© ê¸°íš ì˜ë„ ë° ëª©ì ](#-ê¸°íš-ì˜ë„-ë°-ëª©ì )
- [ğŸ‘¥ íŒ€ ì†Œê°œ](#-íŒ€-ì†Œê°œ)
- [âš™ï¸ ê°œë°œ í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ](#ï¸-ê°œë°œ-í™˜ê²½-ë°-ê¸°ìˆ -ìŠ¤íƒ)
- [ğŸ“† ê°œë°œ ì¼ì •](#-ê°œë°œ-ì¼ì •)
- [ğŸ§­ ì„œë¹„ìŠ¤ êµ¬ì„±ë„](#-ì„œë¹„ìŠ¤-êµ¬ì„±ë„)
- [ğŸ§© ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½](#-ì£¼ìš”-ê¸°ëŠ¥-ìš”ì•½)
- [ğŸ—‚ï¸ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°](#ï¸-í”„ë¡œì íŠ¸-ë””ë ‰í† ë¦¬-êµ¬ì¡°)
- [ğŸ”’ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ğŸ–¥ ì£¼ìš” JSP í˜ì´ì§€](#-ì£¼ìš”-jsp-í˜ì´ì§€)
- [ğŸ“« API ì—°ë™ ìš”ì•½](#-api-ì—°ë™-ìš”ì•½)
- [âœ… í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½](#-í•µì‹¬-í¬ì¸íŠ¸-ìš”ì•½)
- [ğŸ”„ KOPIS ê³µì—° ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸ â€” ìì„¸í•œ íë¦„](#-kopis-ê³µì—°-ë°ì´í„°-ìë™-ì—…ë°ì´íŠ¸--ìì„¸í•œ-íë¦„)
    
---

## ğŸ“… í”„ë¡œì íŠ¸ ê°œìš”
> **ê³µê³µë°ì´í„° ê¸°ë°˜ ê³µì—° ì˜ˆë§¤Â·ê´€ë¦¬ í†µí•© í”Œë«í¼**

**TicketProject**ëŠ” KOPIS(ê³µì—°ì˜ˆìˆ í†µí•©ì „ì‚°ë§)ì˜ ê³µì—° ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ  
ì‚¬ìš©ìì—ê²Œ **ê³µì—° ì¡°íšŒ â†’ ì˜ˆë§¤ â†’ ê²°ì œ â†’ ë¦¬ë·° ì‘ì„±**ê¹Œì§€  
ëª¨ë“  ê³¼ì •ì„ í•œ ë²ˆì— ì œê³µí•˜ëŠ” ê³µì—° ì˜ˆë§¤ ë° ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ§© ê¸°íš ì˜ë„ ë° ëª©ì 

### ğŸ¯ ê¸°íš ì˜ë„
- ê³µê³µë°ì´í„°(OpenAPI)ë¥¼ í™œìš©í•˜ì—¬ **ì‹¤ì œ ê³µì—° ë°ì´í„°ë¥¼ ë°˜ì˜í•œ ì‹¤ì‹œê°„ ì˜ˆë§¤ ì„œë¹„ìŠ¤ ì œê³µ**
- ê³µì—° ê´€ë ¨ ì •ë³´ë¥¼ ì¢…í•© ì œê³µí•˜ì—¬ ì‚¬ìš©ì ì ‘ê·¼ì„± í–¥ìƒ

### ğŸ§­ í”„ë¡œì íŠ¸ ëª©ì 
- **Spring MVC + MyBatis** ê¸°ë°˜ì˜ ëª¨ë“ˆí™”ëœ êµ¬ì¡°ë¡œ ìœ ì§€ë³´ìˆ˜ì„±ê³¼ í™•ì¥ì„± í™•ë³´  
- **Spring Security**ë¥¼ í†µí•œ ê¶Œí•œ ê´€ë¦¬ ë° ì ‘ê·¼ ì œì–´ êµ¬í˜„  
- **Spring Scheduler**ë¡œ ê³µì—° ë°ì´í„° ìë™ ê°±ì‹   
- ì‹¤ë¬´í˜• í˜‘ì—… ë° ë¬¸ì„œí™” ëŠ¥ë ¥ í–¥ìƒì„ ëª©í‘œë¡œ í•¨  

---

## ğŸ‘¥ íŒ€ ì†Œê°œ

| ì—­í•  | ì£¼ìš” ë‹´ë‹¹ |
|------|------------|
| ğŸ’¼ **íŒ€ì¥ ê¹€ìƒí™”** | UML ì „ë°˜ ì‘ì„±, ê³µì§€ì‚¬í•­ í”„ë¡œí† íƒ€ì… ë° ë°œí‘œìë£Œ ì œì‘, ê³µì§€Â·ë¦¬ë·°Â·ì‹ ê³ Â·ê´€ë¦¬ìÂ·ë©”ì¸ ê¸°ëŠ¥ êµ¬í˜„ |
| ğŸ§  **íŒ€ì› ë°±ìŠ¹ìš°** | HTML í”„ë¡œí† íƒ€ì… ì‘ì„±, ìš”êµ¬ì‚¬í•­ ë° ì œì•ˆì„œ ì‘ì„±, ê³µì—° ê´€ë¦¬ ë° ì˜ˆë§¤ ê¸°ëŠ¥ êµ¬í˜„ |
| ğŸ§¾ **íŒ€ì› ê¶Œì§„ì™„** | ë¬¸ì„œ ì¢…í•© ë° ERD ì‘ì„±, DB êµ¬ì¶•, ì‹œíë¦¬í‹° ì„¤ì •, íšŒì›ê°€ì…/ë¡œê·¸ì¸/ê²°ì œ/ë§ˆì´í˜ì´ì§€ êµ¬í˜„ |

---

## âš™ï¸ ê°œë°œ í™˜ê²½ ë° ê¸°ìˆ  ìŠ¤íƒ

| êµ¬ë¶„ | ë‚´ìš© |
|------|------|
| **ê°œë°œ í™˜ê²½** | Apache Tomcat 9.0 / Oracle MySQL 8.0 / Oracle JDK 13.0.2 / GitHub |
| **ê°œë°œ ë„êµ¬** | Spring 4 / StarUML 6.2.2 / VSCode |
| **ê¸°ìˆ  ìŠ¤íƒ** | HTML5 / CSS3 / JavaScript / JSP / MyBatis / Spring Security / Spring Scheduler / JSTL / JavaMailSender |

---

## ğŸ“† ê°œë°œ ì¼ì •

| ë‹¨ê³„ | ê¸°ê°„ |
|------|------|
| í”„ë¡œì íŠ¸ ê¸°íš | ~ 24.11.28 |
| ìš”êµ¬ì‚¬í•­ ë¶„ì„ | ~ 24.12.03 |
| ì‹œìŠ¤í…œ ì„¤ê³„ | ~ 24.12.05 |
| í™”ë©´ ì„¤ê³„ ë° êµ¬í˜„ | ~ 24.12.10 |
| **ê°œë°œ ê¸°ê°„** | **24.12.10 ~ 24.12.31** |

---

## ğŸ§­ ì„œë¹„ìŠ¤ êµ¬ì„±ë„

![ì„œë¹„ìŠ¤ êµ¬ì„±ë„](https://github.com/kimsanghw/ticketproject/blob/main/ppt/service-structure.png)

### ê¸°ëŠ¥ ìš”ì•½
- **ë¡œê·¸ì¸ / íšŒì›ê°€ì…** â†’ ì¼ë°˜ ì‚¬ìš©ì, ê³µì—°ì¥ ì‚¬ìš©ì êµ¬ë¶„  
- **ê³µì—° ê´€ë¦¬** â†’ ê³µì—° ë“±ë¡, ìˆ˜ì •, ì‚­ì œ (ê³µì—°ì¥ ì „ìš©)  
- **ì˜ˆë§¤ ê´€ë¦¬** â†’ ê³µì—° ì˜ˆë§¤ ë° ê²°ì œ, ì¢Œì„ í™•ì¸  
- **ë¦¬ë·° ê´€ë¦¬** â†’ ë¦¬ë·° ì‘ì„±Â·ìˆ˜ì •Â·ì‚­ì œÂ·ì‹ ê³   
- **ê´€ë¦¬ì í˜ì´ì§€** â†’ ê³µì—°ì¥ ìŠ¹ì¸, ì‹ ê³  ì²˜ë¦¬, ê³µì§€ì‚¬í•­ ê´€ë¦¬  
- **ê³µì§€ì‚¬í•­ ê²Œì‹œíŒ** â†’ CRUD ê¸°ëŠ¥  

---

## ğŸ§© ì£¼ìš” ê¸°ëŠ¥ ìš”ì•½

| êµ¬ë¶„ | ê¸°ëŠ¥ëª… | ì„¤ëª… |
|------|---------|------|
| **íšŒì›ê´€ë¦¬** | íšŒì›ê°€ì… / ë¡œê·¸ì¸ / ì´ë©”ì¼ ì¸ì¦ | ì¼ë°˜íšŒì›Â·ê³µì—°ì¥íšŒì› êµ¬ë¶„ ê°€ì… / ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë°œì†¡ |
| **ê³µì—°ê´€ë¦¬** | ê³µì—° ë“±ë¡Â·ìˆ˜ì •Â·ì‚­ì œ | ê³µì—°ì¥ íšŒì› ì „ìš© ê´€ë¦¬ í˜ì´ì§€ |
| **ì˜ˆë§¤ì‹œìŠ¤í…œ** | ì˜ˆë§¤ / ì¢Œì„ í™•ì¸ | ë‚ ì§œÂ·íšŒì°¨ë³„ ì˜ˆë§¤ ê°€ëŠ¥, ì”ì—¬ì¢Œì„ ì‹¤ì‹œê°„ í™•ì¸ |
| **ê²°ì œì‹œìŠ¤í…œ** | KakaoPay ì—°ë™ | ê²°ì œ ìŠ¹ì¸Â·ì·¨ì†Œ ì²˜ë¦¬ |
| **ë¦¬ë·°/ì‹ ê³ ** | ë¦¬ë·° CRUD ë° ì‹ ê³  ê¸°ëŠ¥ | ê³µì—°ë³„ í›„ê¸° ì‘ì„± ë° ê´€ë¦¬ì ê²€í†  |
| **ê³µì§€ì‚¬í•­** | CRUD | ê´€ë¦¬ì ì „ìš© ê²Œì‹œíŒ |
| **ìë™ ìŠ¤ì¼€ì¤„ëŸ¬** | KOPIS API ìë™ ê°±ì‹  | ìµœì‹  ê³µì—° ì •ë³´ ìë™ ì—…ë°ì´íŠ¸ |
| **ë³´ì•ˆ/ê¶Œí•œ** | Spring Security | ê´€ë¦¬ìÂ·ê³µì—°ì¥Â·ì¼ë°˜ ì‚¬ìš©ìë³„ ì ‘ê·¼ ì œì–´ |

---

## ğŸ—‚ï¸ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```plaintext
ticketproject/
â”œâ”€â”€ src/main/java/com/ticketproject/
â”‚   â”œâ”€â”€ controller/
â”‚   â”‚   â”œâ”€â”€ AdminController.java
â”‚   â”‚   â”œâ”€â”€ HomeController.java
â”‚   â”‚   â”œâ”€â”€ MyController.java
â”‚   â”‚   â”œâ”€â”€ NoticeController.java
â”‚   â”‚   â”œâ”€â”€ PaymentController.java
â”‚   â”‚   â”œâ”€â”€ PerformanceController.java
â”‚   â”‚   â”œâ”€â”€ PerformanceMyController.java
â”‚   â”‚   â”œâ”€â”€ ReportController.java
â”‚   â”‚   â”œâ”€â”€ ReservationController.java
â”‚   â”‚   â”œâ”€â”€ ReviewController.java
â”‚   â”‚   â””â”€â”€ UserController.java
â”‚   â”‚
â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ AdminDAO.java
â”‚   â”‚   â”œâ”€â”€ MyDAO.java
â”‚   â”‚   â”œâ”€â”€ NoticeDAO.java
â”‚   â”‚   â”œâ”€â”€ PaymentDAO.java
â”‚   â”‚   â”œâ”€â”€ PerformanceDAO.java
â”‚   â”‚   â”œâ”€â”€ PrfImgDAO.java
â”‚   â”‚   â”œâ”€â”€ ReportDAO.java
â”‚   â”‚   â”œâ”€â”€ ReservationDAO.java
â”‚   â”‚   â”œâ”€â”€ ReviewDAO.java
â”‚   â”‚   â”œâ”€â”€ RprfDAO.java
â”‚   â”‚   â””â”€â”€ UserDAO.java
â”‚   â”‚
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â”œâ”€â”€ AdminService(+Impl)
â”‚   â”‚   â”œâ”€â”€ EmailService(+Impl)
â”‚   â”‚   â”œâ”€â”€ MyService(+Impl)
â”‚   â”‚   â”œâ”€â”€ NoticeService(+Impl)
â”‚   â”‚   â”œâ”€â”€ PaymentService(+Impl)
â”‚   â”‚   â”œâ”€â”€ PerformanceService(+Impl)
â”‚   â”‚   â”œâ”€â”€ PrfImgService(+Impl)
â”‚   â”‚   â”œâ”€â”€ ReportService(+Impl)
â”‚   â”‚   â”œâ”€â”€ ReservationService(+Impl)
â”‚   â”‚   â”œâ”€â”€ ReviewService(+Impl)
â”‚   â”‚   â”œâ”€â”€ RprfService(+Impl)
â”‚   â”‚   â”œâ”€â”€ UserAuthenticationService.java
â”‚   â”‚   â””â”€â”€ UserService(+Impl)
â”‚   â”‚
â”‚   â”œâ”€â”€ scheduler/
â”‚   â”‚   â””â”€â”€ ApiScheduler.java
â”‚   â”‚
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ MailConfig.java
â”‚   â”‚
â”‚   â”œâ”€â”€ util/
â”‚   â”‚   â”œâ”€â”€ PagingUtil.java
â”‚   â”‚   â”œâ”€â”€ SessionUtils.java
â”‚   â”‚   â””â”€â”€ VerificationCodeGenerator.java
â”‚   â”‚
â”‚   â””â”€â”€ vo/
â”‚       â”œâ”€â”€ ApproveResponse.java
â”‚       â”œâ”€â”€ HallVO.java
â”‚       â”œâ”€â”€ KakaoPayReadyVO.java
â”‚       â”œâ”€â”€ LoginUserVO.java
â”‚       â”œâ”€â”€ NoticeVO.java
â”‚       â”œâ”€â”€ OrderCreateForm.java
â”‚       â”œâ”€â”€ PaymentVO.java
â”‚       â”œâ”€â”€ PerformanceVO.java
â”‚       â”œâ”€â”€ PrfImgVO.java
â”‚       â”œâ”€â”€ ReadyResponse.java
â”‚       â”œâ”€â”€ ReportVO.java
â”‚       â”œâ”€â”€ ReservationVO.java
â”‚       â”œâ”€â”€ ReviewVO.java
â”‚       â”œâ”€â”€ RprfVO.java
â”‚       â”œâ”€â”€ SearchVO.java
â”‚       â””â”€â”€ UserVO.java
â”‚
â”œâ”€â”€ src/main/resources/
â”‚   â”œâ”€â”€ mappers/
â”‚   â”‚   â”œâ”€â”€ HallMapper.xml
â”‚   â”‚   â”œâ”€â”€ MyMapper.xml
â”‚   â”‚   â”œâ”€â”€ NoticeMapper.xml
â”‚   â”‚   â”œâ”€â”€ PaymentMapper.xml
â”‚   â”‚   â”œâ”€â”€ PerformanceMapper.xml
â”‚   â”‚   â”œâ”€â”€ PrfImgMapper.xml
â”‚   â”‚   â”œâ”€â”€ ReportMapper.xml
â”‚   â”‚   â”œâ”€â”€ ReservationMapper.xml
â”‚   â”‚   â”œâ”€â”€ ReviewMapper.xml
â”‚   â”‚   â”œâ”€â”€ RprfMapper.xml
â”‚   â”‚   â””â”€â”€ UserMapper.xml
â”‚   â”œâ”€â”€ email-context.xml
â”‚   â”œâ”€â”€ log4j.xml
â”‚   â””â”€â”€ mybatis_config.xml
â”‚
â””â”€â”€ src/main/webapp/
    â”œâ”€â”€ resources/
    â”‚   â”œâ”€â”€ img/
    â”‚   â”œâ”€â”€ js/
    â”‚   â””â”€â”€ upload/
    â”œâ”€â”€ WEB-INF/views/
    â”‚   â”œâ”€â”€ include/
    â”‚   â”‚   â”œâ”€â”€ header.jsp
    â”‚   â”‚   â””â”€â”€ footer.jsp
    â”‚   â”œâ”€â”€ adminpage/
    â”‚   â”‚   â””â”€â”€ adminPage.jsp
    â”‚   â”œâ”€â”€ mypage/
    â”‚   â”‚   â”œâ”€â”€ mypage.jsp
    â”‚   â”‚   â”œâ”€â”€ mypageModify.jsp
    â”‚   â”‚   â””â”€â”€ performanceMypage.jsp
    â”‚   â”œâ”€â”€ notice/
    â”‚   â”‚   â”œâ”€â”€ noticeList.jsp
    â”‚   â”‚   â”œâ”€â”€ noticeView.jsp
    â”‚   â”‚   â”œâ”€â”€ noticeWrite.jsp
    â”‚   â”‚   â””â”€â”€ noticeModify.jsp
    â”‚   â”œâ”€â”€ performance/
    â”‚   â”‚   â”œâ”€â”€ performance_write.jsp
    â”‚   â”‚   â”œâ”€â”€ performance_modify.jsp
    â”‚   â”‚   â”œâ”€â”€ performance_view.jsp
    â”‚   â”‚   â”œâ”€â”€ declaration.jsp
    â”‚   â”‚   â””â”€â”€ performance_check.jsp
    â”‚   â”œâ”€â”€ reservation/
    â”‚   â”‚   â”œâ”€â”€ ticket_check.jsp
    â”‚   â”‚   â””â”€â”€ payment.jsp
    â”‚   â”œâ”€â”€ user/
    â”‚   â”‚   â”œâ”€â”€ join.jsp
    â”‚   â”‚   â””â”€â”€ login.jsp
    â”‚   â””â”€â”€ home.jsp
    â”œâ”€â”€ web.xml
    â””â”€â”€ pom.xml

```
---

## ğŸ”’ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
- **Spring MVC 3-Tier êµ¬ì¡°
  Controller â†’ Service â†’ DAO â†’ MyBatis Mapper â†’ DB**
- **Spring Scheduler : KOPIS API ìë™ ê°±ì‹ **
- **Spring Security : ì‚¬ìš©ì ê¶Œí•œ(Role)ë³„ ì ‘ê·¼ ì œì–´**
- **JavaMailSender + email-context.xml : ì´ë©”ì¼ ì¸ì¦ ì²˜ë¦¬**
- **KakaoPay API ì—°ë™ : ê²°ì œ ìŠ¹ì¸ ë° ì·¨ì†Œ ì²˜ë¦¬**


---

## ğŸ–¥ ì£¼ìš” JSP í˜ì´ì§€

| ì¹´í…Œê³ ë¦¬         | íŒŒì¼ëª…                                   | ì£¼ìš” ê¸°ëŠ¥                   |
| ------------ | ------------------------------------- | ----------------------- |
| **ë©”ì¸**       | `home.jsp`                            | ê³µì—° ë¦¬ìŠ¤íŠ¸, ìµœì‹  ê³µì—°, â€œë”ë³´ê¸°â€ ë²„íŠ¼ |
| **ê³µì—°ê´€ë¦¬**     | `performance_write.jsp`               | ê³µì—° ë“±ë¡, ë‚ ì§œ ì„ íƒ, íšŒì°¨ ë“±ë¡     |
|              | `performance_modify.jsp`              | ê³µì—° ìˆ˜ì •                   |
|              | `performance_view.jsp`                | ê³µì—° ìƒì„¸ ì¡°íšŒ                |
| **ì˜ˆë§¤/ê²°ì œ**    | `ticket_check.jsp`, `payment.jsp`     | ì˜ˆë§¤ ë° KakaoPay ê²°ì œ        |
| **íšŒì›/ë³´ì•ˆ**    | `join.jsp`, `login.jsp`               | ê°€ì… ë° ë¡œê·¸ì¸, ì´ë©”ì¼ ì¸ì¦        |
| **ë§ˆì´í˜ì´ì§€**    | `mypage.jsp`, `performanceMypage.jsp` | ì˜ˆë§¤ë‚´ì—­, ê³µì—° ê´€ë¦¬             |
| **ê³µì§€ì‚¬í•­/ê´€ë¦¬ì** | `noticeList.jsp`, `adminPage.jsp`     | ê³µì§€ì‚¬í•­ CRUD, ì‹ ê³  ì²˜ë¦¬        |


---

## ğŸ“« API ì—°ë™ ìš”ì•½

| API                                    | ì—­í•                |
| -------------------------------------- | ---------------- |
| **KOPIS API**                          | ê³µì—° ì •ë³´ ìë™ ìˆ˜ì§‘      |
| **KakaoPay API**                       | ê²°ì œ ìŠ¹ì¸ ë° ê²°ì œ ì •ë³´ ìˆ˜ì‹  |
| **JavaMailSender (email-context.xml)** | ì´ë©”ì¼ ì¸ì¦ë²ˆí˜¸ ë°œì†¡      |

---

## âœ… í•µì‹¬ í¬ì¸íŠ¸ ìš”ì•½
- ì™„ì„±í˜• Spring MVC êµ¬ì¡° (Controller â†’ Service â†’ DAO â†’ Mapper)
- KOPIS ê³µì—° ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸ (Scheduler)
- KakaoPay ê²°ì œ + JavaMail ì´ë©”ì¼ ì¸ì¦ ì—°ë™
- Spring Security ê¸°ë°˜ ê¶Œí•œë³„ ì ‘ê·¼ ì œì–´


---
## ğŸ”„ KOPIS ê³µì—° ë°ì´í„° ìë™ ì—…ë°ì´íŠ¸ â€” ìì„¸í•œ íë¦„

ìŠ¤ì¼€ì¤„ëŸ¬ ëª¨ë“ˆì€ **ë°ì´í„° ìˆ˜ì§‘ íŠ¸ë¦¬ê±°(ìŠ¤ì¼€ì¤„)**, **1ì°¨ ëª©ë¡ ìˆ˜ì§‘/ì €ì¥**, **2ì°¨ ìƒì„¸ ìˆ˜ì§‘/ì—…ë°ì´íŠ¸**, **ì´ë¯¸ì§€(styurl) ì €ì¥**ìœ¼ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤.  
êµ¬í˜„ì€ `ApiScheduler â†’ PerformanceService(+Impl) â†’ PerformanceDAO/PrfImgDAO â†’ MyBatis Mapper(XML)` ìˆœì„œë¡œ ë™ì‘í•©ë‹ˆë‹¤.

---

### 1) ë°ì´í„° ìˆ˜ì§‘ íŠ¸ë¦¬ê±° (ìŠ¤ì¼€ì¤„)

- **í´ë˜ìŠ¤**: `com.ticketproject.scheduler.ApiScheduler`  
- **ë©”ì„œë“œ**: `apiScheduler()`  
- **Cron**: `0 0 12 1/1 *  *` *(ì´ˆ ë¶„ ì‹œ ì¼ ì›” ìš”ì¼ ì—°ë„)*  
- **ëª©ì **: ê¸°ì¤€ì¼ **Â±15ì¼** ê¸°ê°„ìœ¼ë¡œ 1ì°¨ ëª©ë¡ ìˆ˜ì§‘ â†’ ì €ì¥ í›„, DBì— ì ì¬ëœ `mt20id` ì „ë¶€ì— ëŒ€í•´ **ìƒì„¸ API** ì¶”ê°€ ì¡°íšŒ/ì—…ë°ì´íŠ¸

```java
@Scheduled(cron= "0 0 12 1/1 *  * ") //ì´ˆ ë¶„ ì‹œ ì¼ ì›” ìš”ì¼ ì—°ë„
    public void apiScheduler() throws Exception {
		//ê³µì—° ëª©ë¡ ìš”ì²­ í›„ DBì— ì €ì¥
    	System.out.println("ìŠ¤ì¼€ì¤„ëŸ¬ ì‹¤í–‰ë¨");
    	//System.out.println("1q");
    	
    	// í˜„ì¬ ì‹œê°„ ê³„ì‚°
        LocalDateTime now = LocalDateTime.now();

        // 15ì¼ ì „ê³¼ í›„ì˜ ë‚ ì§œ ê³„ì‚°
        LocalDateTime startDate = now.minus(15, ChronoUnit.DAYS);
        LocalDateTime endDate = now.plus(15, ChronoUnit.DAYS);

        // ë‚ ì§œ í˜•ì‹ ì„¤ì • (ì˜ˆ: "yyyyMMdd")
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyyMMdd");

        // ë™ì ìœ¼ë¡œ ë‚ ì§œ ìƒì„±
        String stdate = startDate.format(formatter);
        String eddate = endDate.format(formatter);

        StringBuilder urlBuilder = new StringBuilder("http://www.kopis.or.kr/openApi/restful/pblprfr");
        urlBuilder.append("?" + URLEncoder.encode("service", "UTF-8") + "=a78255aae24e4b758994653483598aef");
        urlBuilder.append("&" + URLEncoder.encode("stdate", "UTF-8") + "=" + URLEncoder.encode(stdate, "UTF-8"));
        urlBuilder.append("&" + URLEncoder.encode("eddate", "UTF-8") + "=" + URLEncoder.encode(eddate, "UTF-8"));
        urlBuilder.append("&" + URLEncoder.encode("cpage", "UTF-8") + "=" + URLEncoder.encode("1", "UTF-8"));
        urlBuilder.append("&" + URLEncoder.encode("rows", "UTF-8") + "=" + URLEncoder.encode("48", "UTF-8"));
        urlBuilder.append("&" + URLEncoder.encode("fcltychartr", "UTF-8") + "=" + URLEncoder.encode("4", "UTF-8"));
        urlBuilder.append("&" + URLEncoder.encode("shcate", "UTF-8") + "=" + URLEncoder.encode("AAAA", "UTF-8"));

        URL url = new URL(urlBuilder.toString());
        
        HttpURLConnection conn = (HttpURLConnection) url.openConnection();
        conn.setRequestMethod("GET");
        conn.setRequestProperty("Content-type", "application/xml");

        SAXBuilder builder = new SAXBuilder();
       
        Document document = builder.build(conn.getInputStream());
        
        Element root = document.getRootElement();
       
        List<Element> dbElements = root.getChildren("db");
       
        
        

        List<PerformanceVO> performanceList = new ArrayList<PerformanceVO>();
        List<PrfImgVO> prfimgList = new ArrayList<PrfImgVO>();
        List<String> mt20ids = performanceService.selectMt20id();

        for (Element dbElement : dbElements) {
        	
            PerformanceVO performance = new PerformanceVO();
            performance.setMt20id(dbElement.getChildText("mt20id"));
            performance.setPrfnm(dbElement.getChildText("prfnm"));
            performanceList.add(performance);
           

            PrfImgVO prfimg = new PrfImgVO();
            prfimg.setPoster(dbElement.getChildText("poster"));
            prfimg.setPrfid(performance.getPrfid());
            prfimgList.add(prfimg);
            //System.out.println("7ë²ˆ"+prfimgList);
            
            
        }
        performanceService.savePerformanceAndImages(performanceList, prfimgList);
        
        
        //ì—¬ê¸°ì„œë¶€í„° ê³µì—° ìƒì„¸ ì •ë³´ ìš”ì²­í›„ DBì— ì €ì¥í•˜ê¸°
        //DBì—ì„œ ì¡°íšŒ í•´ì˜¨ mt20id ì „ë¶€ ë½‘ê¸°
        List<PerformanceVO> inDBList = performanceService.getAllmt20id();
        
        //ê³µì—° ìƒì„¸ë¡œ ìš”ì²­ ë³´ë‚´ê¸° mt20idëŠ” ì €ì¥ë˜ì–´ ìˆìœ¼ë‹ˆ DBë¥¼ ëŒì•„ì„œ ì•„ì´ë”” ì „ë¶€ ê°€ì ¸ì˜¤ê³  
        for(PerformanceVO performance2 : inDBList) {
        	//System.out.println("mt20id ë¦¬ìŠ¤íŠ¸ ë°˜ë³µì¤‘..");
        	String mt20id = performance2.getMt20id();
        	StringBuilder urlBuilder2 = new StringBuilder("http://www.kopis.or.kr/openApi/restful/pblprfr");
            urlBuilder2.append("/" +  mt20id);
            urlBuilder2.append("?" + URLEncoder.encode("service", "UTF-8") + "=a78255aae24e4b758994653483598aef");
            
            URL url2 = new URL(urlBuilder2.toString());
            HttpURLConnection conn2 = (HttpURLConnection) url2.openConnection();
            conn2.setRequestMethod("GET");
            conn2.setRequestProperty("Content-type", "application/xml");
            //System.out.println(url2);
            SAXBuilder builder2 = new SAXBuilder();
            Document document2 = builder2.build(conn2.getInputStream());
            Element root2 = document2.getRootElement();
            List<Element> dbElements2 = root2.getChildren("db");
            //System.out.println("dbElements2 size : "+dbElements2.size());
            //System.out.println("ìš”ì²­ì™„ë£Œ");
            //ì—¬ê¸°ìœ„ë¡œ ì‹¤í–‰ì™„ë£Œ
            
            
            
            //ê°€ì ¸ì˜¨ ê³µì—°ìƒì„¸ ë°ì´í„°ë¥¼ í¼í¬ë¨¼ìŠ¤ ê° ì¹¼ëŸ¼ì— ì €ì¥
            Map<String, PerformanceVO> updatePrf = new HashMap<>();
            Map<String, PrfImgVO> updateImg = new HashMap<>(); 
            
            for (Element dbElement2 : dbElements2) {
                PerformanceVO performance = new PerformanceVO();
                performance.setMt20id(mt20id);
                performance.setPrfcast(dbElement2.getChildText("prfcast"));
                //System.out.println(dbElement2.getChildText("prfcast"));
                performance.setPrfcrew(dbElement2.getChildText("prfcrew"));
                //System.out.println(dbElement2.getChildText("prfcrew"));
                performance.setPrfruntime(dbElement2.getChildText("prfruntime"));
                //System.out.println(dbElement2.getChildText("prfruntime"));
                performance.setPcseguidance(dbElement2.getChildText("pcseguidance"));
                //System.out.println(dbElement2.getChildText("pcseguidance"));
                performance.setPrfpdfrom(dbElement2.getChildText("prfpdfrom"));
                //System.out.println(dbElement2.getChildText("prfpdfrom"));
                performance.setPrfpdto(dbElement2.getChildText("prfpdto"));
                //System.out.println(dbElement2.getChildText("prfpdto"));
                updatePrf.put(mt20id, performance);
                //System.out.println(updatePrf);
                performanceService.updatePrfInfo(updatePrf);
               
        
                PrfImgVO prfImg = new PrfImgVO();
                //styuri ë¶„ë¦¬ ì‹œì¼œì•¼í•¨ (4ê°œ ì´ìƒ ìˆì„ê²½ìš° ìˆìŒ)
               Element styurlsElement = dbElement2.getChild("styurls");
               //System.out.println(dbElement2.getChild("styurls").getContentSize());
               if (styurlsElement != null) {
                   List<Element> styurlList = styurlsElement.getChildren("styurl");
                   for (int i = 0; i < styurlList.size(); i++) {
                       String styurlContent = styurlList.get(i).getText();
                       switch (i) {
                           case 0: prfImg.setStyuri1(styurlContent); break;
                           case 1: prfImg.setStyuri2(styurlContent); break;
                           case 2: prfImg.setStyuri3(styurlContent); break;
                           case 3: prfImg.setStyuri4(styurlContent); break;
                       }
                       updateImg.put(mt20id, prfImg);
                       PrfImgService.updateStyurl(updateImg);
                   }
               }
           }
            
            
        }
    }
```

### 2) 1ì°¨ ìˆ˜ì§‘ â€” ê³µì—° ëª©ë¡(ìš”ì•½) â†’ ì €ì¥

- **ìš”ì²­ URL(ì˜ˆì‹œ)**
  
	`GET http://www.kopis.or.kr/openApi/restful/pblprfr?service=...&stdate=yyyyMMdd&eddate=yyyyMMdd&cpage=1&rows=48&fcltychartr=4&shcate=AAAA`


- **íŒŒì‹±**  
	- **XML ì‘ë‹µì˜ `<db>` ëª©ë¡ì„ **JDOM2**ë¡œ íŒŒì‹±í•˜ì—¬ **`mt20id`, `prfnm`, `poster`** ì¶”ì¶œ**

- **ì €ì¥ íë¦„**  
	1. `PerformanceVO(mt20id, prfnm)` ë¦¬ìŠ¤íŠ¸ êµ¬ì„±  
	2. `PrfImgVO(poster, prfid)` ë¦¬ìŠ¤íŠ¸ êµ¬ì„± *(í¬ìŠ¤í„° URL)*  
	3. `performanceService.savePerformanceAndImages(list1, list2)` í˜¸ì¶œ

- **Service/DAO í•µì‹¬ ì‹œê·¸ë‹ˆì²˜**
```java
// Service
void savePerformanceAndImages(List<PerformanceVO> performances, List<PrfImgVO> prfimgs);
```
```sql
<!-- Mapper (namespace = com.ticketproject.mapper.PerformanceMapper) -->
<select id="selectPerformanceByMt20id" parameterType="String" resultType="PerformanceVO">
  SELECT prfid, mt20id, prfnm
    FROM performance
   WHERE mt20id = #{mt20id}
</select>

<insert id="insertPerformance" parameterType="PerformanceVO" useGeneratedKeys="true" keyProperty="prfid">
  INSERT INTO performance (mt20id, prfnm)
  VALUES (#{mt20id}, #{prfnm})
</insert>
```
-**Service êµ¬í˜„**
```java
// com.ticketproject.service.PerformanceServiceImpl
@Transactional
public void savePerformanceAndImages(List<PerformanceVO> performanceList, List<PrfImgVO> prfimgList) {
    for (PerformanceVO performance : performanceList) {
        // 1) ê³µì—° ì¡´ì¬ ì—¬ë¶€ í™•ì¸
        PerformanceVO existingPerformance =
            performanceDAO.selectPerformanceByMt20id(performance.getMt20id());

        int prfid;
        if (existingPerformance == null) {
            // 2) ì‹ ê·œë©´ INSERT (useGeneratedKeys=true ë¡œ prfid ì„¸íŒ…)
            performanceDAO.insertPerformance(performance);
            prfid = performance.getPrfid();
        } else {
            // 3) ê¸°ì¡´ì´ë©´ prfid ì¬ì‚¬ìš©
            prfid = existingPerformance.getPrfid();
        }

        // 4) í¬ìŠ¤í„°(PrfImg) ì €ì¥
        for (PrfImgVO prfimg : prfimgList) {
            // í˜„ì¬ ë§¤ì¹­ ê¸°ì¤€ì€ prfid. (ë¹Œë“œ ì‹œì /ì €ì¥ ì‹œì  ì°¨ì´ ì£¼ì˜)
            if (performance.getPrfid() == prfimg.getPrfid()) {
                prfimg.setPrfid(prfid);       // ì •í™•í•œ FK ì£¼ì…
                prfimgDAO.insertPrfimg(prfimg);
                break;
            }
        }
    }
}
```
ë™ì‘ ìš”ì•½: mt20idë¡œ ê³µì—° ì¡´ì¬ ì—¬ë¶€ ê²€ì‚¬ â†’ ì—†ìœ¼ë©´ INSERT í›„ ìƒì„±ëœ prfidë¡œ í¬ìŠ¤í„° ì €ì¥.


